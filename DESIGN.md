# DQ1-Sample 設計書

**プロジェクト名:** DQ1-Sample（ファミコン版ドラゴンクエスト1 再現プロジェクト）
**言語/フレームワーク:** Python 3.11+ / Pygame 2.5+
**作成日:** 2026-02-17

---

## 目次

1. [システム概要](#1-システム概要)
2. [アーキテクチャ設計](#2-アーキテクチャ設計)
3. [モジュール構成](#3-モジュール構成)
4. [画面・定数設計](#4-画面定数設計)
5. [ステート管理](#5-ステート管理)
6. [マップシステム](#6-マップシステム)
7. [プレイヤーシステム](#7-プレイヤーシステム)
8. [戦闘システム](#8-戦闘システム)
9. [NPC・ショップ・宿屋システム](#9-npcショップ宿屋システム)
10. [UIシステム](#10-uiシステム)
11. [描画システム](#11-描画システム)
12. [データ定義](#12-データ定義)
13. [既知の制限・今後の課題](#13-既知の制限今後の課題)

---

## 1. システム概要

### 1.1 プロジェクト概要

本プロジェクトはファミコン版「ドラゴンクエスト1」を Python + Pygame で再現する2D RPGです。タイルベースのマップ移動、ターン制1対1戦闘、NPC会話、装備・アイテム・呪文システムを備えています。

### 1.2 技術スタック

| 項目 | 内容 |
|------|------|
| 言語 | Python 3.11+ |
| フレームワーク | Pygame 2.5+ |
| 描画方式 | プログラム描画（スプライトアセット不使用） |
| フォント | 日本語対応システムフォント自動検出 |
| マップ形式 | 文字列配列ベース |

### 1.3 操作方法

| キー | 操作 |
|------|------|
| 方向キー | 移動 |
| Z | 決定 / はなす |
| X | キャンセル |
| Space | メニュー |
| Escape | 終了 |

---

## 2. アーキテクチャ設計

### 2.1 全体構成図

```
main.py（エントリポイント）
  └── Game（メインループ管理）
        ├── state_stack[]  ← ステートスタックパターン
        │   ├── TitleState      （タイトル画面）
        │   ├── FieldState      （フィールド探索）
        │   └── BattleState     （戦闘画面）
        ├── Player              （プレイヤーデータ）
        └── pygame.display      （描画サーフェス）
```

### 2.2 設計パターン

| パターン | 適用箇所 | 説明 |
|----------|----------|------|
| State Stack | Game.state_stack | ステートを積み上げ/取り除きで画面遷移を管理 |
| Message Queue | MessageWindow | メッセージを順次表示するキュー管理 |
| Weighted Random | エンカウントテーブル | 敵の出現率を重み付きで制御 |
| Font Cache | Font クラス | フォントをシングルトンでキャッシュ |
| Tile Render Cache | TileMap._render_tile | タイル画像を初回描画時にキャッシュ |

### 2.3 ステート遷移図

```
┌────────────┐    Zキー     ┌────────────┐   エンカウント   ┌────────────┐
│ TitleState │ ──────────→ │ FieldState │ ─────────────→ │BattleState │
│ (タイトル)  │  change      │ (フィールド) │    push         │  (戦闘)    │
└────────────┘             └────────────┘ ←───────────── └────────────┘
                                │    ↑         pop
                                │    │
                           load_map (ワープ)
                           マップ切替は同一ステート内で処理
```

---

## 3. モジュール構成

### 3.1 ファイル一覧

```
DQ1-Sample/
├── main.py              # エントリポイント
├── requirements.txt     # 依存パッケージ (pygame)
└── src/
    ├── __init__.py      # パッケージ初期化（空）
    ├── config.py        # 定数・設定
    ├── data.py          # ゲームデータ定義
    ├── player.py        # プレイヤークラス
    ├── ui.py            # UI コンポーネント群
    ├── tilemap.py       # タイルマップ描画・当たり判定
    ├── game.py          # メインゲームループ・ステート管理
    ├── title.py         # タイトル画面ステート
    ├── field.py         # フィールド探索ステート
    └── battle.py        # 戦闘ステート
```

### 3.2 モジュール依存関係

```
main.py
  └── game.py
        ├── config.py
        ├── player.py ← data.py (LEVEL_TABLE, SPELLS, ITEMS, WEAPONS, ARMORS, SHIELDS)
        ├── title.py ← config.py, ui.py
        ├── field.py ← config.py, data.py, player.py, ui.py, tilemap.py, battle.py
        └── battle.py ← config.py, data.py, player.py, ui.py
```

### 3.3 各モジュールの責務

| モジュール | 責務 |
|-----------|------|
| `main.py` | アプリケーション起動。Gameインスタンスを生成し実行 |
| `config.py` | タイルサイズ、画面サイズ、色、キー設定、タイル定義等の定数管理 |
| `data.py` | 敵、アイテム、呪文、レベルテーブル、マップ、NPC等の全ゲームデータ |
| `player.py` | プレイヤーのステータス、装備、インベントリ、戦闘計算式 |
| `ui.py` | DQスタイルのウィンドウ、テキスト表示、メニュー、ステータス表示 |
| `tilemap.py` | マップのタイル描画、カメラ処理、当たり判定、キャラクター描画 |
| `game.py` | メインループ、イベント処理、ステートスタック管理 |
| `title.py` | タイトル画面の表示と入力処理 |
| `field.py` | マップ移動、NPC会話、ショップ、エンカウント、ワープ処理 |
| `battle.py` | ターン制戦闘の全処理（コマンド選択〜勝敗判定） |

---

## 4. 画面・定数設計

### 4.1 画面設定

| 定数 | 値 | 説明 |
|------|-----|------|
| `TILE_SIZE` | 48px | 1タイルのピクセルサイズ |
| `SCREEN_TILES_X` | 16 | 横方向の表示タイル数 |
| `SCREEN_TILES_Y` | 15 | 縦方向の表示タイル数 |
| `SCREEN_WIDTH` | 768px | 画面幅 (16 × 48) |
| `SCREEN_HEIGHT` | 720px | 画面高さ (15 × 48) |
| `FPS` | 60 | フレームレート |
| `MOVE_FRAMES` | 8 | 1タイル移動のフレーム数 |

### 4.2 カラーパレット（NESスタイル）

| 定数 | RGB値 | 用途 |
|------|-------|------|
| `BLACK` | (0, 0, 0) | 背景色 |
| `WHITE` | (252, 252, 252) | 文字色・枠線 |
| `WINDOW_BG` | (0, 0, 0) | ウィンドウ背景 |
| `WINDOW_BORDER` | (252, 252, 252) | ウィンドウ枠 |

### 4.3 タイル種別

| 定数 | ID | 文字 | 色 (RGB) | 通行 | エンカウント |
|------|----|------|----------|------|------------|
| `TILE_GRASS` | 0 | G | (34,139,34) | 可 | あり |
| `TILE_WATER` | 1 | W | (65,105,225) | 不可 | - |
| `TILE_MOUNTAIN` | 2 | M | (139,90,43) | 不可 | - |
| `TILE_FOREST` | 3 | F | (0,100,0) | 可 | あり |
| `TILE_DESERT` | 4 | D | (210,180,140) | 可 | あり |
| `TILE_BRIDGE` | 5 | B | (139,90,43) | 可 | あり |
| `TILE_FLOOR` | 6 | . | (139,119,101) | 可 | - |
| `TILE_WALL` | 7 | # | (105,105,105) | 不可 | - |
| `TILE_DOOR` | 8 | + | (139,90,43) | 可 | - |
| `TILE_STAIRS_DOWN` | 9 | > | (80,80,80) | 可 | - |
| `TILE_STAIRS_UP` | 10 | < | (80,80,80) | 可 | - |
| `TILE_CASTLE` | 11 | C | (192,192,192) | 可 | - |
| `TILE_TOWN` | 12 | T | (160,82,45) | 可 | - |
| `TILE_CAVE` | 13 | V | (64,64,64) | 可 | - |
| `TILE_SWAMP` | 14 | S | (75,0,130) | 可 | あり |
| `TILE_ROOF` | 15 | R | (178,34,34) | 不可 | - |
| `TILE_COUNTER` | 16 | K | (139,90,43) | 不可 | - |
| `TILE_CHEST` | 17 | X | (218,165,32) | 可 | - |
| `TILE_THRONE` | 18 | O | (218,165,32) | 可 | - |

### 4.4 キー設定

| 定数 | Pygameキー | 操作 |
|------|-----------|------|
| `KEY_UP` | K_UP | 上移動 |
| `KEY_DOWN` | K_DOWN | 下移動 |
| `KEY_LEFT` | K_LEFT | 左移動 |
| `KEY_RIGHT` | K_RIGHT | 右移動 |
| `KEY_CONFIRM` | K_z | 決定 / はなす |
| `KEY_CANCEL` | K_x | キャンセル |
| `KEY_MENU` | K_SPACE | メニュー開閉 |

---

## 5. ステート管理

### 5.1 Game クラス

```python
class Game:
    screen: pygame.Surface      # 描画サーフェス
    clock: pygame.time.Clock    # FPS制御
    running: bool               # ゲームループフラグ
    player: Player              # プレイヤーインスタンス
    state_stack: list           # ステートスタック
```

**ステート操作メソッド:**

| メソッド | 動作 | 使用例 |
|---------|------|--------|
| `push_state(state)` | スタックに追加 | 戦闘開始（フィールドの上に重ねる） |
| `pop_state()` | 最上位を除去 | 戦闘終了（フィールドに戻る） |
| `change_state(state)` | 最上位を入替 | タイトル → フィールド |

**メインループ:**

```
run():
  while running:
    _handle_events()   # イベント処理 → current_state.handle_event()
    _update()          # ステート更新 → current_state.update()
    _draw()            # 描画 → current_state.draw()
    clock.tick(FPS)    # 60FPS制御
```

### 5.2 ステートインターフェース

各ステートは以下のメソッドを実装:

| メソッド | 引数 | 責務 |
|---------|------|------|
| `handle_event(event)` | pygame.event | キー入力・イベント処理 |
| `update()` | なし | フレームごとの状態更新 |
| `draw(surface)` | pygame.Surface | 画面描画 |

---

## 6. マップシステム

### 6.1 マップ定義形式

マップは `data.py` に文字列リストとして定義。各文字が1タイルに対応。

```python
FIELD_MAP = [
    "WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW",  # 40文字 = 40タイル幅
    "WGGGGMMMGGGGGGGGGGGGGGGGGGGGGMMMMGGGGGWW",
    ...
]  # 40行 = 40タイル高さ
```

### 6.2 マップ一覧

| マップ名 | サイズ | エンカウント率 | テーブル | 説明 |
|---------|--------|-------------|---------|------|
| `field` | 40×40 | 15% (可変) | 距離依存 | フィールドマップ |
| `castle` | 16×16 | なし | - | ラダトーム城 |
| `town` | 16×16 | なし | - | 町 |
| `dungeon_b1` | 16×16 | 20% | dungeon | ダンジョンB1 |
| `dungeon_b2` | 16×16 | 25% | dungeon | ダンジョンB2 |

### 6.3 ワープ定義

マップ間の移動はワープポイントで管理。タイルに到達すると自動的に転送。

| 出発マップ | 座標 | 到着マップ | 座標 |
|-----------|------|-----------|------|
| field | (19,14) | castle | (7,14) |
| castle | (7,14) | field | (19,14) |
| field | (12,19) | town | (7,15) |
| town | (7,15) | field | (12,19) |
| field | (11,6) | dungeon_b1 | (2,2) |
| field | (9,29) | dungeon_b1 | (2,2) |
| dungeon_b1 | (2,2) | field | (11,6) |
| dungeon_b1 | (9,13) | dungeon_b2 | (2,2) |
| dungeon_b2 | (2,2) | dungeon_b1 | (9,13) |

### 6.4 エンカウント判定

フィールドマップでは城（座標 19,14）からの距離でエンカウントテーブルが変化:

```
距離 < 10  → field_start （低レベル敵）
距離 < 20  → field_mid   （中レベル敵）
距離 >= 20 → field_far   （高レベル敵）
```

エンカウント対象タイル: 草、森、砂漠、沼、橋

### 6.5 宝箱

| マップ | 座標 | 内容 |
|--------|------|------|
| dungeon_b1 | (7, 6) | 120ゴールド |
| dungeon_b2 | (4, 9) | てつのおの |

開封済み宝箱は `Player.opened_chests` で追跡し、再取得不可。描画時は床タイルに変更。

### 6.6 TileMap クラス

```python
class TileMap:
    tiles: list[list[int]]   # 2次元タイルID配列

    get_tile(x, y) → int           # 座標のタイルID取得（範囲外は-1）
    is_passable(x, y) → bool       # 通行可能判定
    draw(surface, camera_x, camera_y, opened_chests)  # カメラ基準で描画
```

**カメラシステム:** プレイヤーを常に画面中央に配置。表示範囲外のタイルはカリング。

---

## 7. プレイヤーシステム

### 7.1 Player クラス

```python
class Player:
    # 基本情報
    name: str = 'ゆうしゃ'
    level: int              # 1〜30
    exp: int                # 経験値

    # ステータス
    max_hp: int             # 最大HP（レベルテーブル参照）
    hp: int                 # 現在HP
    max_mp: int             # 最大MP（レベルテーブル参照）
    mp: int                 # 現在MP
    strength: int           # ちから（レベルテーブル参照）
    agility: int            # すばやさ（レベルテーブル参照）
    gold: int               # 所持金

    # 装備
    weapon: str             # 武器名
    armor: str              # 鎧名
    shield: str             # 盾名

    # インベントリ
    items: list[str]        # 所持アイテム（最大8個）

    # 位置情報
    map_name: str           # 現在のマップ名
    tile_x: int             # タイルX座標
    tile_y: int             # タイルY座標
    direction: tuple        # 向き (dx, dy)

    # フラグ
    opened_chests: set      # 開封済み宝箱 (map, x, y)
    flags: set              # ストーリーフラグ
```

### 7.2 戦闘力計算式（DQ1準拠）

```
こうげき力 = ちから + 武器の攻撃力
しゅび力   = すばやさ ÷ 2（切り捨て） + 鎧の守備力 + 盾の守備力
```

### 7.3 レベルアップ

`gain_exp(amount)` で経験値を獲得。レベルテーブルの必要経験値に達するとレベルアップ。

レベルアップ時:
- max_hp, max_mp, strength, agility が新レベルの値に更新
- 現在のHP/MPは増加分だけ回復
- 新しい呪文を習得する場合がある

### 7.4 アイテム管理

| メソッド | 動作 |
|---------|------|
| `add_item(name)` | アイテム追加（最大8個） |
| `remove_item(name)` | アイテム1個削除 |
| `use_item(name)` | 消耗品使用（やくそう: HP25回復） |
| `can_equip(name)` | 装備可能判定 |
| `equip(name)` | 装備変更、旧装備を返却 |

---

## 8. 戦闘システム

### 8.1 戦闘フェーズ

```
PHASE_APPEAR ─→ PHASE_COMMAND ─→ PHASE_EXECUTE ─→ PHASE_COMMAND（継続）
  (敵出現)      (コマンド選択)    (ターン実行)         ↓（勝敗確定時）
                    ↓                              PHASE_RESULT
              PHASE_SPELL_SELECT                      ↓
              PHASE_ITEM_SELECT                  PHASE_LEVEL_UP（該当時）
                                                      ↓
                                                  PHASE_END
                                                  (pop_state)
```

### 8.2 コマンド

| コマンド | 動作 |
|---------|------|
| たたかう | 通常攻撃 |
| じゅもん | 呪文選択（攻撃/回復/状態異常） |
| どうぐ | アイテム使用（消耗品のみ） |
| にげる | 逃走判定 |

### 8.3 ダメージ計算式

```
ダメージ = こうげき力 − しゅび力 ÷ 2 ± ランダム(1〜3)
最低ダメージ = 1（0以下の場合）
```

### 8.4 ターン順序

```
判定値 = すばやさ + ランダム(0〜10)
判定値が高い方が先攻
```

### 8.5 逃走判定

```
成功率 = プレイヤーすばやさ ÷ 敵すばやさ × 0.75
失敗時は敵のボーナスターン発生
```

### 8.6 状態異常

| 状態 | 効果 | 回復条件 |
|------|------|---------|
| 眠り (sleep) | 行動不能 | 毎ターン33%で覚醒 |
| 沈黙 (silence) | 呪文使用不可 | （戦闘中は回復しない） |

### 8.7 敵の行動AI

```
30%の確率で呪文を使用（呪文を持っている場合）
  → 攻撃呪文: ダメージを与える
  → 状態呪文: プレイヤーに状態異常
特殊攻撃を持っている場合:
  → fire_breath:        16〜24 ダメージ
  → fire_breath_strong: 30〜45 ダメージ
上記以外:
  → 通常攻撃（ダメージ計算式に従う）
```

### 8.8 勝利・敗北処理

**勝利時:**
- 経験値とゴールドを獲得
- レベルアップ判定（複数レベル上がる場合あり）

**敗北時:**
- HP → 最大HPの50%で復活
- MP → 最大MPの50%で復活
- ゴールド → 半減
- ラダトーム城（castle, 7, 14）にテレポート

---

## 9. NPC・ショップ・宿屋システム

### 9.1 NPC定義

NPCはマップ名をキーとしてリスト管理:

```python
{
    "name": "NPC名",
    "x": タイルX座標,
    "y": タイルY座標,
    "color": (R, G, B),        # NPC表示色
    "message": ["会話テキスト行1", "行2", ...],
    "shop": [...],             # ショップの場合（省略可）
    "inn": True                # 宿屋の場合（省略可）
}
```

### 9.2 NPC一覧

**ラダトーム城 (castle):**

| NPC名 | 座標 | 種別 | 内容 |
|--------|------|------|------|
| おうさま | (7,7) | 会話 | 旅立ちの激励 |
| へいし | (3,10) | 会話 | 操作説明 |
| しょうにん | (12,10) | ショップ | たけざお、こんぼう、かわのふく、かわのたて、やくそう、たいまつ |

**町 (town):**

| NPC名 | 座標 | 種別 | 内容 |
|--------|------|------|------|
| むらびと | (3,5) | 会話 | 村の情報 |
| ろうじん | (12,5) | 会話 | ロトの伝説 |
| ぶきや | (3,10) | ショップ | どうのつるぎ、てつのおの、くさりかたびら、てつのたて |
| やどや | (12,10) | 宿屋 | 6ゴールドで全回復 |

### 9.3 ショップシステム

1. NPCに話しかけるとショップメニュー表示
2. アイテム選択 → 所持金チェック → インベントリ空きチェック
3. 装備品は自動装備（武器/鎧/盾の判定）
4. 購入後メッセージ表示
5. 売却機能は未実装

### 9.4 宿屋システム

1. NPCに話しかけると宿泊確認（はい/いいえ）
2. 料金: 6ゴールド
3. 所持金チェック → HP/MP全回復

---

## 10. UIシステム

### 10.1 フォント管理

**自動検出順序:** ipagothic → ipaexgothic → notosanscjkjp → notosansjp → takao → VL-Gothic → フォールバック（デフォルトフォント）

**Font クラス（シングルトン）:**
- `Font.get(size)` でキャッシュされたフォントを取得
- 同一サイズの再生成を防止

### 10.2 Window クラス（DQ風ウィンドウ）

```
┌─────────────────┐  ← 白枠線（二重線、3px幅）
│                 │
│  テキスト領域    │  ← 黒背景、パディング12px
│                 │
└─────────────────┘
```

| 設定 | 値 |
|------|-----|
| 枠線幅 | 3px |
| パディング | 12px |
| 背景色 | 黒 (0,0,0) |
| 枠線色 | 白 (252,252,252) |

### 10.3 TextRenderer クラス（文字送り）

- 1文字ずつ表示（DQスタイル）
- 表示速度: 2フレーム/文字
- 全文表示後にカーソル点滅
- Zキーで即時全文表示（スキップ）

### 10.4 Menu クラス（選択メニュー）

- 三角カーソル（▶）による選択
- 上下キーで移動（ラップアラウンド）
- 複数列レイアウト対応
- Zキーで決定（選択インデックス返却）
- Xキーでキャンセル（-1返却）

### 10.5 StatusWindow クラス

画面右上に常時表示:

```
┌────────────┐
│ HP  15/ 15 │
│ MP   0/  0 │
└────────────┘
```

### 10.6 MessageWindow クラス

画面下部にメッセージ表示。キュー管理で複数メッセージを順次表示。

```
┌──────────────────────────────────┐
│ スライムが あらわれた！            │
│                              ▼   │
└──────────────────────────────────┘
```

---

## 11. 描画システム

### 11.1 タイル描画

各タイルは48×48ピクセルのSurfaceとしてプログラム描画。スプライト画像は不使用。

**タイルごとの描画内容:**

| タイル | 描画内容 |
|--------|---------|
| 草 | 緑の背景 |
| 水 | 青の背景 + 波線 |
| 山 | 茶の背景 + 三角形 + 雪の頂上 |
| 森 | 濃緑の背景 + 木の円 |
| 城 | 石壁 + 塔 + ドア |
| 町 | 屋根 + ドア |
| 洞窟 | 暗い背景 + 楕円 |
| 階段(下) | 遠近法の下り階段 |
| 階段(上) | 遠近法の上り階段 |
| 宝箱 | 茶色の箱 + 金のハイライト |
| 玉座 | 椅子 + 肘掛け |
| 橋 | 木の板（水上） |
| 壁 | レンガパターン |
| ドア | 木のドア |
| 屋根 | 三角屋根 |
| 沼 | 暗い円 |

### 11.2 キャラクター描画

**プレイヤー:**
- 体: 青い矩形
- 頭: 肌色の円
- 髪: 円弧
- 目: 向きに応じた位置に描画
- 足: 茶色の矩形

**NPC:**
- プレイヤーと同構造
- 体の色はNPCごとに設定

### 11.3 カメラシステム

- プレイヤーを常に画面中央に配置
- カメラ座標 = プレイヤー座標 − 画面中央オフセット
- 表示範囲外のタイル・NPCはカリング

### 11.4 移動アニメーション

- 1タイル移動 = 8フレーム（48px ÷ 8 = 6px/フレーム）
- 移動中はピクセル単位のオフセットで滑らかに描画
- キー押しっぱなしで連続移動

---

## 12. データ定義

### 12.1 レベルテーブル（抜粋）

| Lv | 必要経験値 | HP | MP | ちから | すばやさ |
|----|-----------|-----|-----|--------|---------|
| 1 | 0 | 15 | 0 | 4 | 4 |
| 2 | 7 | 22 | 0 | 5 | 4 |
| 3 | 23 | 24 | 5 | 7 | 6 |
| 5 | 110 | 35 | 12 | 12 | 8 |
| 10 | 1300 | 70 | 38 | 30 | 30 |
| 15 | 4000 | 100 | 68 | 50 | 48 |
| 20 | 13000 | 140 | 100 | 72 | 72 |
| 25 | 34000 | 180 | 148 | 105 | 92 |
| 30 | 65535 | 210 | 200 | 140 | 110 |

### 12.2 呪文一覧

| 呪文名 | 習得Lv | MP | 種別 | 威力/効果 |
|--------|--------|-----|------|----------|
| ホイミ | 3 | 4 | 回復 | HP24回復 |
| ギラ | 4 | 2 | 攻撃 | 10ダメージ |
| ラリホー | 7 | 2 | 状態 | 眠り |
| レミーラ | 9 | 3 | フィールド | 照明 |
| マホトーン | 10 | 2 | 状態 | 沈黙 |
| リレミト | 13 | 6 | フィールド | 脱出 |
| ルーラ | 15 | 8 | フィールド | 帰還 |
| トヘロス | 15 | 2 | フィールド | エンカウント抑制 |
| ベホイミ | 17 | 10 | 回復 | HP85回復 |
| ベギラマ | 19 | 5 | 攻撃 | 58ダメージ |

### 12.3 武器

| 武器名 | 攻撃力 | 価格 |
|--------|--------|------|
| なし | 0 | - |
| たけざお | 2 | 10G |
| こんぼう | 4 | 60G |
| どうのつるぎ | 10 | 180G |
| てつのおの | 15 | 560G |
| はがねのつるぎ | 20 | 1500G |
| ほのおのつるぎ | 28 | 9800G |
| ロトのつるぎ | 40 | - (宝) |

### 12.4 鎧

| 鎧名 | 守備力 | 価格 |
|-------|--------|------|
| なし | 0 | - |
| ぬののふく | 2 | 20G |
| かわのふく | 4 | 70G |
| くさりかたびら | 10 | 300G |
| てつのよろい | 16 | 800G |
| はがねのよろい | 21 | 3000G |
| まほうのよろい | 24 | 7700G |
| ロトのよろい | 28 | - (宝) |

### 12.5 盾

| 盾名 | 守備力 | 価格 |
|-------|--------|------|
| なし | 0 | - |
| かわのたて | 2 | 90G |
| てつのたて | 10 | 800G |
| みかがみのたて | 20 | 14800G |

### 12.6 敵一覧

| 敵名 | HP | 攻撃 | 守備 | 素早さ | 経験値 | ゴールド | 特殊 |
|------|-----|------|------|--------|--------|---------|------|
| スライム | 3 | 5 | 3 | 3 | 1 | 2 | - |
| ドラキー | 6 | 9 | 6 | 6 | 2 | 3 | - |
| ゴースト | 7 | 11 | 8 | 8 | 3 | 5 | - |
| まほうつかい | 13 | 11 | 12 | 10 | 4 | 12 | ギラ |
| おおさそり | 20 | 18 | 16 | 10 | 6 | 16 | - |
| リカント | 34 | 40 | 30 | 22 | 16 | 40 | - |
| ゴーレム | 70 | 48 | 40 | 18 | 5 | 10 | - |
| しにがみのきし | 50 | 52 | 35 | 36 | 28 | 70 | ラリホー |
| ドラゴン | 65 | 56 | 42 | 30 | 35 | 150 | 火の息 |
| りゅうおう(人型) | 100 | 80 | 75 | 50 | 0 | 0 | ベギラマ / ラリホー |
| りゅうおう(竜) | 130 | 120 | 100 | 60 | 0 | 0 | 強火の息 |

### 12.7 エンカウントテーブル

**field_start（城近辺）:**

| 敵名 | 出現率 |
|------|--------|
| スライム | 60% |
| ドラキー | 30% |
| ゴースト | 10% |

**field_mid（中距離）:**

| 敵名 | 出現率 |
|------|--------|
| おおさそり | 40% |
| まほうつかい | 30% |
| ゴースト | 20% |
| ドラキー | 10% |

**field_far（遠距離）:**

| 敵名 | 出現率 |
|------|--------|
| リカント | 30% |
| しにがみのきし | 30% |
| おおさそり | 20% |
| まほうつかい | 20% |

**dungeon（ダンジョン共通）:**

| 敵名 | 出現率 |
|------|--------|
| まほうつかい | 30% |
| おおさそり | 30% |
| ゴースト | 20% |
| しにがみのきし | 20% |

---

## 13. 既知の制限・今後の課題

| 項目 | 状態 | 説明 |
|------|------|------|
| セーブ/ロード | 未実装 | ゲーム進行の保存・読み込み |
| 音楽・効果音 | 未実装 | BGM、SE の再生 |
| フィールド呪文 | 簡略化 | 最初の回復呪文のみフィールドで使用可能 |
| ショップ売却 | 未実装 | アイテムの売却機能 |
| ダンジョン照明 | 未実装 | 暗闘・たいまつ/レミーラによる照明 |
| 竜王の城 | 未実装 | 最終ダンジョンの実装 |
| NPC アニメーション | 未実装 | NPCの移動・方向変化 |
| 戦闘アニメーション | 未実装 | 攻撃・呪文のエフェクト |
| ストーリー進行 | 未実装 | クエストフラグによるストーリー管理 |
| スプライト対応 | 未実装 | 画像アセットによるキャラクター・タイル描画 |

---

*本設計書は DQ1-Sample リポジトリのソースコードに基づいて作成されました。*
